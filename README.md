# ABP Bookify

**Bookify** is a modern apartment booking platform built with the ABP Framework. It provides a complete solution for managing apartments, bookings, and reviews using Domain-Driven Design (DDD) principles and CQRS pattern.

## üèóÔ∏è Architecture

This solution follows a **layered monolith architecture** based on Domain-Driven Design (DDD) practices:

- **Domain Layer**: Core business logic and domain entities
- **Application Layer**: Application services, commands, queries, and handlers (CQRS with MediatR)
- **Entity Framework Core Layer**: Data access and database context
- **HTTP API Layer**: RESTful API endpoints
- **Angular Frontend**: Modern single-page application

## ‚ú® Features

### Core Domain Features

- **Apartment Management**: Create, update, and search apartments with amenities, pricing, and descriptions
- **Booking System**: Reserve, confirm, reject, complete, and cancel bookings with validation
- **Review System**: Add and manage reviews for apartments
- **Pricing Management**: Automatic price calculation including cleaning fees and amenities upcharge

### Technical Features

- **CQRS Pattern**: Command Query Responsibility Segregation using MediatR
- **Domain Events**: Event-driven architecture for domain events
- **Outbox Pattern**: Reliable message processing
- **Multi-tenancy**: Support for multiple tenants
- **Identity & Access Management**: User authentication and authorization
- **Permission Management**: Fine-grained permission system
- **Audit Logging**: Track all changes and operations
- **Localization**: Multi-language support

## üõ†Ô∏è Technology Stack

### Backend

- **.NET 9.0+** - Latest .NET framework
- **ABP Framework 9.1+** - Application framework
- **Entity Framework Core** - ORM for data access
- **PostgreSQL** - Relational database
- **Redis** - Caching and distributed cache
- **MediatR** - CQRS implementation
- **FluentValidation** - Input validation
- **AutoMapper** - Object mapping
- **Serilog** - Logging with Seq integration
- **OpenIddict** - Authentication and authorization

### Frontend

- **Angular 19** - Modern web framework
- **ABP Angular UI** - ABP framework UI components
- **LeptonX Theme** - Modern UI theme
- **Bootstrap Icons** - Icon library
- **RxJS** - Reactive programming

## üìã Prerequisites

Before running the application, ensure you have the following installed:

- [.NET 9.0+ SDK](https://dotnet.microsoft.com/download/dotnet)
- [Node.js v20.11+](https://nodejs.org/en)
- [PostgreSQL](https://www.postgresql.org/download/) (or use Docker)
- [Redis](https://redis.io/download) (optional, for caching)
- [Seq](https://datalust.co/seq) (optional, for log viewing)

## üöÄ Getting Started

### 1. Clone the Repository

```bash
git clone <repository-url>
cd ABP_Bookify
```

### 2. Configure Database Connection

Update the connection strings in:

- `aspnet-core/src/ITE.Bookify.HttpApi.Host/appsettings.json`
- `aspnet-core/src/ITE.Bookify.DbMigrator/appsettings.json`

```json
{
  "ConnectionStrings": {
    "Default": "User ID=postgres;Password=admin;Host=localhost;Port=5432;Database=Bookify;",
    "Cache": "localhost:6379"
  }
}
```

### 3. Generate Signing Certificate (if needed)

The certificate is usually already generated by ABP CLI. If you need to generate it manually:

```bash
dotnet dev-certs https -v -ep openiddict.pfx -p 740a0d5e-07d0-4b7b-ba4b-6aa5cac07cd4
```

### 4. Install Client-Side Libraries

Navigate to the Angular directory and install dependencies:

```bash
cd angular
npm install
```

Or use ABP CLI:

```bash
abp install-libs
```

### 5. Create and Seed Database

Run the database migrator to create the database and seed initial data:

```bash
cd aspnet-core/src/ITE.Bookify.DbMigrator
dotnet run
```

### 6. Run the Backend API

```bash
cd aspnet-core/src/ITE.Bookify.HttpApi.Host
dotnet run
```

The API will be available at `https://localhost:44397`

### 7. Run the Frontend

Open a new terminal and navigate to the Angular directory:

```bash
cd angular
npm start
```

Or use the PowerShell script:

```powershell
.\start.ps1
```

The application will open at `http://localhost:4200`

## üìÅ Solution Structure

```text
ABP_Bookify/
‚îú‚îÄ‚îÄ angular/                          # Angular frontend application
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ apartment/           # Apartment management module
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ booking/             # Booking management module
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ home/                # Home page module
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ shared/              # Shared components and pipes
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ assets/                  # Static assets
‚îÇ   ‚îî‚îÄ‚îÄ package.json
‚îÇ
‚îî‚îÄ‚îÄ aspnet-core/                      # .NET backend solution
    ‚îî‚îÄ‚îÄ src/
        ‚îú‚îÄ‚îÄ ITE.Bookify.Domain/              # Domain layer (entities, domain logic)
        ‚îÇ   ‚îú‚îÄ‚îÄ Apartments/                  # Apartment domain entities
        ‚îÇ   ‚îú‚îÄ‚îÄ Bookings/                    # Booking domain entities
        ‚îÇ   ‚îî‚îÄ‚îÄ Reviews/                     # Review domain entities
        ‚îÇ
        ‚îú‚îÄ‚îÄ ITE.Bookify.Domain.Shared/       # Shared domain objects (DTOs, constants)
        ‚îÇ
        ‚îú‚îÄ‚îÄ ITE.Bookify.Application/         # Application layer (services, handlers)
        ‚îÇ   ‚îú‚îÄ‚îÄ Apartments/                  # Apartment application services
        ‚îÇ   ‚îú‚îÄ‚îÄ Bookings/                    # Booking application services
        ‚îÇ   ‚îî‚îÄ‚îÄ Reviews/                     # Review application services
        ‚îÇ
        ‚îú‚îÄ‚îÄ ITE.Bookify.Application.Contracts/ # Application contracts (interfaces, DTOs)
        ‚îÇ
        ‚îú‚îÄ‚îÄ ITE.Bookify.EntityFrameworkCore/   # EF Core data access layer
        ‚îÇ
        ‚îú‚îÄ‚îÄ ITE.Bookify.HttpApi/             # HTTP API layer
        ‚îÇ
        ‚îú‚îÄ‚îÄ ITE.Bookify.HttpApi.Host/        # API host application
        ‚îÇ   ‚îî‚îÄ‚îÄ appsettings.json             # Application configuration
        ‚îÇ
        ‚îî‚îÄ‚îÄ ITE.Bookify.DbMigrator/          # Database migration tool
```

## üîë Default Credentials

After running the database migrator, you can use the default admin credentials:

- **Username**: `admin`
- **Password**: `1q2w3E*`

> **Note**: Change the default password after first login for security.

## üß™ Testing

### Backend Tests

```bash
cd aspnet-core/test/ITE.Bookify.Application.Tests
dotnet test
```

### Frontend Tests

```bash
cd angular
npm test
```

## üìö Key Concepts

### Domain Entities

- **Apartment**: Represents a bookable apartment with amenities, pricing, and location
- **Booking**: Represents a reservation with status tracking (Reserved, Confirmed, Rejected, Completed, Cancelled)
- **Review**: User reviews and ratings for apartments

### CQRS Commands & Queries

- **Commands**: CreateApartment, UpdateApartment, ReserveBooking, ConfirmBooking, etc.
- **Queries**: GetApartment, SearchApartments, GetBooking, etc.

### Domain Events

- **BookingReservedDomainEvent**: Fired when a booking is reserved

## üîß Configuration

### Application Settings

Key configuration options in `appsettings.json`:

- **DataSeeding**: Enable/disable apartment seed data
- **Outbox**: Configure outbox pattern interval and batch size
- **Serilog**: Configure logging sinks (Console, Seq)
- **AuthServer**: OpenIddict configuration

### Environment Variables

You can override settings using environment variables or `appsettings.secrets.json` (not tracked in git).

## üìñ Additional Resources

- [ABP Framework Documentation](https://abp.io/docs/latest)
- [ABP Web Application Tutorial](https://abp.io/docs/latest/tutorials/book-store/part-01?UI=Blazor&DB=EF)
- [LeptonX Lite Angular UI](https://abp.io/docs/latest/ui-themes/lepton-x-lite/angular)
- [Domain-Driven Design Guide](https://abp.io/docs/latest/framework/architecture/domain-driven-design)
- [Deployment Documentation](https://abp.io/docs/latest/deployment)

## ü§ù Contributing

This is a learning project based on ABP Framework. Feel free to explore, modify, and extend the functionality.

## üìù License

This project uses the ABP Framework which is licensed under the MIT License.

---

### Built with ‚ù§Ô∏è using ABP Framework
